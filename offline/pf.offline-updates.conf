# Temporary outbound expansion for maintenance windows
# Loaded into anchor "offline-updates" by offline/offline-firewall.sh
# Tables are populated by sync-pf-tables.sh to avoid DNS resolution at load time

# Import macros (wan_if, ts_cidr, etc.)
include "/etc/pf.offline.vars"

table <lmstudio_hosts> persist
table <update_hosts> persist
table <package_repos> persist

# Allow DNS during update window for table sync
pass out on $wan_if proto udp from $ts_cidr to any port 53 keep state

# HTTPS-only to update sources
pass out on $wan_if proto tcp from $ts_cidr to <lmstudio_hosts> port 443 keep state
pass out on $wan_if proto tcp from $ts_cidr to <update_hosts>  port 443 keep state
pass out on $wan_if proto tcp from $ts_cidr to <package_repos> port 443 keep state
